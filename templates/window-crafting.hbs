{{!-- Artificer Crafting Station - 4-zone layout: [recipes][ingredients][crafting area][result] --}}
{{!-- Design follows Quick Encounter: header, sectioned body, action bar --}}

<div class="crafting-window-root">

    {{!-- HEADER (Quick Encounter style) --}}
    <header class="crafting-window-header">
        <div class="crafting-window-header-content">
            <div class="crafting-window-header-icon">
                <i class="fa-solid fa-hammer"></i>
            </div>
            <div class="crafting-window-header-title">Artificer Crafting Station</div>
            <div class="crafting-window-header-controls">
                <span class="crafting-window-crafter-label">{{#if crafterName}}Crafting as: {{crafterName}}{{else}}Select a crafter{{/if}}</span>
            </div>
        </div>
    </header>

    {{!-- BODY: 4 zones --}}
    <div class="crafting-window-body">
        {{!-- Zone 1: Recipes --}}
        <aside class="crafting-zone crafting-zone-recipes">
            <section class="crafting-zone-section">
                <h3 class="crafting-zone-section-title">Recipes</h3>
                <div class="crafting-zone-recipes-list">
                    {{#each knownCombinations}}
                    <div class="crafting-recipe-row">
                        <span class="crafting-recipe-tags">{{#each this.tags}}{{this}}{{#unless @last}} + {{/unless}}{{/each}}</span>
                        <span class="crafting-recipe-arrow">→</span>
                        <span class="crafting-recipe-result">{{this.result}}</span>
                    </div>
                    {{else}}
                    <div class="crafting-zone-empty">No recipes loaded.</div>
                    {{/each}}
                </div>
            </section>
        </aside>

        {{!-- Zone 2: Ingredients --}}
        <aside class="crafting-zone crafting-zone-ingredients">
            <section class="crafting-zone-section">
                <h3 class="crafting-zone-section-title">Ingredients</h3>
                <div class="crafting-zone-section-input-wrap">
                    <input type="text" id="{{appId}}-filter-search" class="crafting-zone-section-input" placeholder="Search..." value="{{filterSearch}}" />
                </div>
                <div class="crafting-zone-filters-row">
                    <select id="{{appId}}-filter-family" class="crafting-zone-select" title="Filter by family">
                        {{#each familyOptions}}
                        <option value="{{this.value}}" {{#if this.selected}}selected{{/if}}>{{this.label}}</option>
                        {{/each}}
                    </select>
                    <select id="{{appId}}-filter-type" class="crafting-zone-select" title="Filter by type">
                        {{#each typeOptions}}
                        <option value="{{this.value}}" {{#if this.selected}}selected{{/if}}>{{this.label}}</option>
                        {{/each}}
                    </select>
                </div>
                <div class="crafting-zone-ingredients-list">
                    {{#each listItems}}
                    <div class="crafting-ingredient-row {{#if this.isContainer}}crafting-container-row{{/if}}" data-action="{{this.addAction}}" data-item-id="{{this.id}}" data-item-uuid="{{this.uuid}}" data-tooltip="{{this.name}}{{#if this.tags}}\nTags: {{this.tags}}{{/if}}" title="{{this.name}}">
                        <img src="{{this.img}}" alt="" class="crafting-ingredient-row-img" />
                        <div class="crafting-ingredient-row-info">
                            <span class="crafting-ingredient-row-name">{{this.name}}</span>
                            <span class="crafting-ingredient-row-qty">×{{this.quantity}}</span>
                        </div>
                    </div>
                    {{else}}
                    <div class="crafting-zone-empty">{{#if showContainersOnly}}No containers in inventory.{{else}}No ingredients or containers in inventory.{{/if}}</div>
                    {{/each}}
                </div>
            </section>
        </aside>

        {{!-- Zone 3: Crafting area --}}
        <main class="crafting-zone crafting-zone-bench">
            <section class="crafting-zone-section">
                <h3 class="crafting-zone-section-title">Crafting Bench</h3>
                {{!-- 6 ingredient slots (2 rows x 3) --}}
                <div class="crafting-bench-ingredient-slots">
                    {{#each slots}}
                    <div class="crafting-bench-slot" data-slot-index="{{@index}}">
                        {{#if this.item}}
                        <div class="crafting-bench-slot-item" data-action="removeFromSlot" data-slot-index="{{@index}}" data-tooltip="{{this.tooltip}}" title="Click to remove">
                            <img src="{{this.item.img}}" alt="" class="crafting-slot-img" />
                        </div>
                        <span class="crafting-bench-slot-count">{{this.count}}</span>
                        {{else}}
                        <div class="crafting-bench-slot-empty">Empty</div>
                        {{/if}}
                    </div>
                    {{/each}}
                </div>
                {{!-- Container + sliders row --}}
                <div class="crafting-bench-process-row">
                    <div class="crafting-bench-slider-wrap crafting-bench-heat-slider" title="Heat: None to High">
                        <div class="crafting-bench-slider-top-label"><i class="fa-solid fa-fire-flame-curved"></i> High</div>
                        <div class="crafting-bench-slider-track">
                            <input type="range" id="{{appId}}-heat" class="crafting-bench-vertical-slider crafting-bench-heat-slider-input" min="0" max="100" value="{{heatValue}}" step="1" data-craft-setting="heat" data-craft-setting-min="0" data-craft-setting-max="100" style="--heat-fill: {{heatFillPercent}}%;" />
                        </div>
                        <div class="crafting-bench-slider-bottom-label">None</div>
                    </div>
                    <div class="crafting-bench-container-slot" data-action="removeContainer" data-tooltip="{{containerSlot.tooltip}}" title="Click to remove container">
                        {{#if containerSlot.item}}
                        <div class="crafting-bench-container-item" data-action="removeContainer">
                            <img src="{{containerSlot.item.img}}" alt="" class="crafting-container-img" />
                        </div>
                        {{else}}
                        <div class="crafting-bench-container-empty">
                            <i class="fa-solid fa-flask"></i>
                            <span>Container</span>
                            <span class="crafting-bench-container-hint">beaker, mortar, etc.</span>
                        </div>
                        {{/if}}
                    </div>
                    <div class="crafting-bench-slider-wrap crafting-bench-time-slider" title="Time: 5 sec to 2 min">
                        <div class="crafting-bench-slider-top-label">120 sec</div>
                        <div class="crafting-bench-slider-track">
                            <input type="range" id="{{appId}}-time" class="crafting-bench-vertical-slider" min="5" max="120" value="{{timeValue}}" step="5" data-craft-setting="time" data-craft-setting-min="5" data-craft-setting-max="120" style="--slider-fill: {{timeFillPercent}}%;" />
                        </div>
                        <div class="crafting-bench-slider-bottom-label">5 sec</div>
                    </div>
                </div>

                {{#if combinedTags.length}}
                <p class="crafting-zone-desc">Tags for this combination:</p>
                <div class="crafting-bench-tags">
                    {{#each combinedTags}}
                    <span class="crafting-tag-badge">{{this}}</span>
                    {{/each}}
                </div>
                {{/if}}
            </section>
        </main>

        {{!-- Zone 4: Result --}}
        <aside class="crafting-zone crafting-zone-result">
            <section class="crafting-zone-section">
                <h3 class="crafting-zone-section-title">Result</h3>
                {{#if lastResult}}
                <div class="crafting-result-box {{#if lastResult.success}}crafting-result-success{{else}}crafting-result-fail{{/if}}">
                    {{#if lastResult.success}}
                    <i class="fa-solid fa-check crafting-result-icon"></i>
                    <div class="crafting-result-name">{{lastResult.name}}</div>
                    <div class="crafting-result-detail">Tags: {{lastCraftTagsStr}}</div>
                    {{else}}
                    <i class="fa-solid fa-times crafting-result-icon"></i>
                    <div class="crafting-result-name">{{lastResult.name}}</div>
                    <div class="crafting-result-detail">Tags: {{lastCraftTagsStr}}</div>
                    {{/if}}
                </div>
                {{else}}
                <div class="crafting-zone-empty">Result will appear here after crafting.</div>
                {{/if}}
            </section>
        </aside>
    </div>

    {{!-- ACTION BAR (Quick Encounter style) --}}
    <section class="crafting-window-buttons">
        <div class="crafting-window-action-buttons">
            <button type="button" class="crafting-window-btn-primary" data-action="craft" {{#unless canCraft}}disabled{{/unless}} title="Craft with selected ingredients">
                <i class="fa-solid fa-wand-magic-sparkles"></i> Craft
            </button>
            <button type="button" class="crafting-window-btn-secondary" data-action="clear" title="Clear all slots">
                <i class="fa-solid fa-eraser"></i> Clear
            </button>
        </div>
    </section>
</div>
