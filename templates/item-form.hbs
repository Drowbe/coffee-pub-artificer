<div class="artificer-window artificer-item-form item-form-crafting-style">
    {{!-- Header (matches crafting window) --}}
    <header class="item-form-header">
        <div class="item-form-header-content">
            <div class="item-form-header-icon">
                <i class="fa-solid fa-hammer"></i>
            </div>
            <div class="item-form-header-title">{{#if isEditMode}}Edit{{else}}Create{{/if}} {{itemTypeName}}</div>
        </div>
    </header>

    {{!-- Content --}}
    <div class="item-form-body">
        {{!-- Core item fields only; price, weight, rarity, source, and license are hard-coded or set in the item sheet after creation. --}}
        <section class="item-form-section">
            <h3 class="item-form-section-title"><i class="fa-solid fa-scroll"></i> Item Details</h3>
            {{> partials/form-field name="itemName" label="Name" type="text" value=itemName placeholder="Item Name"}}
        </section>

        {{!-- Artificer Properties: Type > Family > Traits + Skill Level --}}
        <section class="item-form-section">
            <h3 class="item-form-section-title"><i class="fa-solid fa-tags"></i> Artificer Properties</h3>
            {{> partials/form-field name="artificerType" label="Type" type="select" isSelect=true options=artificerTypeOptions selectClass="crafting-zone-select"}}
            {{> partials/form-field name="family" label="Family" type="select" isSelect=true options=familyOptions selectClass="crafting-zone-select"}}
            {{#if isEssenceFamily}}
            {{> partials/form-field name="affinity" label="Essence Affinity" type="select" isSelect=true options=affinityOptions selectClass="crafting-zone-select"}}
            {{/if}}
            <div class="artificer-form-group artificer-tag-picker-group">
                <label for="artificer-tag-input">Traits</label>
                <div class="artificer-tag-picker">
                    <div class="artificer-tag-input-wrap">
                        <input type="text" id="artificer-tag-input" class="artificer-tag-input" placeholder="e.g. Medicinal, Floral" autocomplete="off" />
                        <button type="button" class="artificer-tag-input-clear" title="Clear" aria-label="Clear"><i class="fa-solid fa-times"></i></button>
                    </div>
                    <div class="artificer-tag-suggestions" id="artificer-tag-suggestions" role="listbox"></div>
                    <div class="artificer-tag-pills" id="artificer-tag-pills"></div>
                    <input type="hidden" name="traits" id="artificer-traits-hidden" value="{{traitsValue}}" />
                </div>
            </div>
            <div class="artificer-form-group artificer-skill-slider-group">
                <label for="skillLevel" title="Minimum crafting skill level required to create or use this item.">Required Skill Level: <span class="artificer-skill-current-value">{{skillLevel}}</span></label>
                <div class="artificer-skill-slider-row">
                    <span class="artificer-skill-slider-label">0</span>
                    <input type="range" name="skillLevel" id="skillLevel" class="artificer-skill-slider" min="0" max="20" value="{{skillLevel}}" step="1" aria-label="Skill level 0-20" style="--skill-fill: {{skillLevelFillPercent}}%;" />
                    <span class="artificer-skill-slider-label">20</span>
                </div>
                
            </div>
            {{#if isComponent}}
            <div class="artificer-form-group artificer-biomes-group">
                <label>Habitat</label>
                <div class="artificer-biomes-grid">
                    {{#each biomeOptions}}
                    <button type="button" class="artificer-biome-btn {{#if selected}}active{{/if}}" data-biome="{{name}}" data-action="toggleBiome">{{name}}</button>
                    {{/each}}
                </div>
                <input type="hidden" name="biomes" id="artificer-biomes-hidden" value="{{biomesValue}}" />
            </div>
            <div class="artificer-form-group">
                <label for="artificer-quirk">Quirk</label>
                <input type="text" name="quirk" id="artificer-quirk" value="{{quirk}}" placeholder="e.g. Found in Battlefields" />
            </div>
            {{/if}}
        </section>
    </div>

    {{!-- Form Actions (matches crafting window: Delete left, Cancel+Save right) --}}
    <section class="item-form-actions">
        <div class="item-form-action-bar">
            <div class="item-form-action-left">
                {{#if isEditMode}}
                <button type="button" data-action="deleteArtificer" class="item-form-btn-delete" title="Remove Artificer tags and properties from this item">
                    <i class="fa-solid fa-trash"></i> Delete Artificer
                </button>
                {{/if}}
            </div>
            <div class="item-form-action-right">
                <button type="button" class="item-form-btn-secondary" data-action="cancel">
                    <i class="fa-solid fa-times"></i> Cancel
                </button>
                <button type="button" data-action="submit" class="item-form-btn-primary">
                    <i class="fa-solid fa-check"></i> {{#if isEditMode}}Save Changes{{else}}Create Item{{/if}}
                </button>
            </div>
        </div>
    </section>
</div>
